document.addEventListener("DOMContentLoaded", () => {
  // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  const DOM = {
    splashText: document.getElementById("splashText"),
    playerName: document.getElementById("playerName"),
    result: document.getElementById("result"),
    suggestions: document.getElementById("suggestions"),
    notification: document.getElementById("notification"),
    checkButton: document.querySelector("button")
  };

  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
  const CONFIG = {
    debounceDelay: 300,
    maxSuggestions: 10,
    checkDelay: 1000,
    notificationTimeout: 3000
  };

  const splashes = [
    "–£ –Ω–∞—Å –Ω–µ—Ç defss_KPACABA!",
    "Kislota –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–¥–∏ –ø–∞—Å—Ö–∞–ª–∫–∏!",
    "–û–π –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–µ —á–∏—Å—Ç–∏–º...",
    "–ù–∞—Å —É–∂–µ 345!",
    "Welcome to Sosmark!",
    "–ê —É –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞ –µ—Å—Ç—å —á–µ–∫–µ—Ä —á—Å?)",
    "3 —Å–∞–º–æ–ª—ë—Ç–∞ –ø—Ä–æ—Ç–∏–≤ —Ç–æ–ª–ø—ã –ª—é–¥–µ–π –≤ —Ç–æ–ø–∫–∞—Ö  ‚Äî 16.06.2024",
    "–í–µ–∫ —Å–æ—Å–∏ - –≤–µ–∫ –ø–µ—Ä–µ—Å–∞—Å—ã–≤–∞–π",
    "–ù–µ–ª—å–∑—è —Å–∂–µ—á—å —Ç–æ —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —à–µ—Å—Ç–∏ –∫–æ–ø–∏—è—Ö",
    "–ù–∞–¥—ë–∂–Ω–µ–µ –≤—Å–µ–≥–æ –ø–∏—Å–∞—Ç—å –Ω–µ –≥–æ—Ä–æ–¥ –∞ –ù–ò–ö!",
    "–ú–æ–¥–∂–∞–Ω–≥ –∑–∞–ø—Ä–µ—Ç–∏–ª–æ –º–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å –Ω–∏–∫–∏!",
    "–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –º–∏—Ä, –Ω—É–∂–Ω–∞ –∫—Ä–∞—Å–∏–≤–∞—è –ª–æ–∂—å –∏ –º–æ—Ä–µ –∫—Ä–æ–≤–∏.",
    "–û–¥–Ω–∞ —Å—Ç—Ä–æ—á–∫–∞ –≤ –ß–° —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏—á–∏–Ω–æ–π —è—Ä–æ—Å—Ç–∏ –Ω–µ–∫–æ–≥–æ rezdne_wagner.",
    "–î–∞ –º—ã —Ç–∏—Ç—Ä—ã –∏–∑ –∑–≤—ë–∑–¥–Ω—ã—Ö –≤–æ–π–Ω!",
    "–ö—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ—Ö –≤—Å–µ –Ω–∏–∫–∏ –≤ —á—Å —Ç–æ—Ç –ø–æ–ø–∞–¥—ë—Ç –≤ —Ä–∞–Ω–¥–æ–º–Ω—ã–µ –Ω–∞–¥–ø–∏—Å–∏!",
    "–ß—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ –ß–° –Ω–∞–ø–∏—à–∏—Ç–µ —Å—é–¥–∞ sosmarkblacklist@gmail.com (–Ω–µ—Ç)",
    "–°–ø—Ä–æ—Å–∏—Ç–µ —É defss_KPACABA –∫–∞–∫ –æ–Ω –≤—ã—à–µ–ª –∏–∑ –ß–° (–µ—Å–ª–∏ –æ–Ω –ø–æ–º–Ω–∏—Ç –µ—â—ë..)",
    "AVE SOS, DEUS OVA",
    "–ù–∞—à –±—é–¥–∂–µ—Ç 1500 –ê–†!",
    "1984",
    "100% –°–æ—Å—Å–∫–∏–π",
    "–ü–æ–º—è–Ω–µ–º",
    "Tobey Maguire got bit by a spider, but see, me, it was‚ÄÖa‚ÄÖgoat",
    "üòà",
    "ü•öü•öü•ö",
    "–ú—ã –¥–æ–±–∞–≤–∏–ª–∏ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏!",
    "17% –°–æ—Å–º–∞—Ä–∫–∞ –≤ –±–∞–Ω–µ..",
    "–Ø –Ω–µ –¥—É–º–∞—é —á—Ç–æ –≤ –º—É–Ω–≤–∏–ª–µ –≤ —Å–º–µ—Ö–µ –∏ –≤ –¥–∏—Å—Ç–æ–ø–∏–∏ –≤–µ—Å—å –∏–ª–∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –°–ü–º..",
    "–í–µ—Å—å –°–ü–º –∞–ª–ª–µ–≥–æ—Ä–∏—è –Ω–∞ FNAF",];

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  function init() {
    initSplashText();
    initEventListeners();
  }

  function initSplashText() {
    if (DOM.splashText) {
      DOM.splashText.textContent = getRandomElement(splashes);
    }
  }

  function initEventListeners() {
    if (DOM.playerName) {
      DOM.playerName.addEventListener("input", debounce(updateSuggestions, CONFIG.debounceDelay));
      DOM.playerName.addEventListener("keypress", (e) => {
        if (e.key === "Enter") checkBlacklist();
      });
    }

    if (DOM.checkButton) {
      DOM.checkButton.addEventListener("click", checkBlacklist);
    }
  }

  // –£—Ç–∏–ª–∏—Ç—ã
  const getRandomElement = (arr) => arr[Math.floor(Math.random() * arr.length)];
  const debounce = (fn, delay) => {
    let timeout;
    return (...args) => {
      clearTimeout(timeout);
      timeout = setTimeout(() => fn(...args), delay);
    };
  };

  // –ê–Ω–∏–º–∞—Ü–∏–∏
  const applyAnimation = (element, animationName) => {
    if (!element) return;
    element.style.animation = `${animationName} 0.5s`;
    element.addEventListener(
      "animationend",
      () => (element.style.animation = ""),
      { once: true }
    );
  };

  // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  const notificationQueue = [];
  let isNotificationShowing = false;

  const processNotificationQueue = () => {
    if (!notificationQueue.length || !DOM.notification) return;
    isNotificationShowing = true;
    
    const { message, callback } = notificationQueue.shift();
    DOM.notification.textContent = message;
    DOM.notification.style.visibility = "visible";
    DOM.notification.style.animation = "fadeInOut 3s";

    setTimeout(() => {
      DOM.notification.style.visibility = "hidden";
      isNotificationShowing = false;
      if (callback) callback();
      processNotificationQueue();
    }, CONFIG.notificationTimeout);
  };

  const showNotification = (message, callback) => {
    notificationQueue.push({ message, callback });
    if (!isNotificationShowing) processNotificationQueue();
  };

  // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏
  const loadConfetti = () => {
    if (typeof confetti === "undefined") {
      const script = document.createElement("script");
      script.src = "https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js";
      document.head.appendChild(script);
    }
  };

  const triggerConfetti = () => {
    if (typeof confetti === "function") {
      confetti({
        particleCount: 658,
        spread: 70,
        origin: { y: 0.6 },
        colors: ["#ff0", "#f0f", "#0ff"],
        disableForReducedMotion: true
      });
    }
  };

  // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
  const checkBlacklist = () => {
    const name = DOM.playerName.value.trim().toLowerCase();
    
    showNotification("–ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...", () => {
      if (!name) {
        showResult("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏", "orange", "shake");
        return;
      }

      const isInList = blacklist.includes(name);
      const resultMessage = isInList 
        ? `${name}, –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –≤—ã –≤ –ß–°!` 
        : `${name}, –≤—ã –Ω–µ –≤ –ß–°! –í–æ–∑–º–æ–∂–Ω–æ –≤—ã —Å–º–µ–Ω–∏–ª–∏ –Ω–∏–∫?`;

      showResult(resultMessage, isInList ? "red" : "green", isInList ? "shake" : "bounce");
      
      if (isInList) {
        triggerConfetti();
      }
    });
  };

  const showResult = (message, color, animation) => {
    if (DOM.result) {
      DOM.result.textContent = message;
      DOM.result.style.color = color;
      applyAnimation(DOM.result, animation);
    }
  };

  const updateSuggestions = () => {
    if (!DOM.suggestions || !DOM.playerName) return;
    
    const input = DOM.playerName.value.toLowerCase();
    DOM.suggestions.innerHTML = "";
    
    if (input.length > 0) {
      const matches = blacklist
        .filter(name => name.includes(input))
        .slice(0, CONFIG.maxSuggestions);

      matches.forEach(name => {
        const div = document.createElement("div");
        div.textContent = name;
        div.className = "suggestion-item";
        div.onclick = () => {
          DOM.playerName.value = name;
          DOM.suggestions.innerHTML = "";
        };
        DOM.suggestions.appendChild(div);
      });
    }
  };

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  loadConfetti();
  init();
});

// –ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä)
const blacklist = [  "DrawingKruper",
  "MegaByte2H",
  "Plazzy_Tw",
  "railxuy",
  "Meruniti",
  "ligofff",
  "prosto_anandy",
  "4epyx__",
  "mistrMonstr",
  "_Venjam1n_",
  "SoFi4Ka_",
  "r0mb_ek",
  "Mrketchup8841",
  "spacekot",
  "NaItvInG",
  "Mamory",
  "Gigiretu",
  "vlady_y",
  "dogi_bb",
  "NotSnaker",
  "forfii",
  "Lanesh_",
  "l1n1ks",
  "voprosek",
  "kekish_",
  "Sauhuk",
  "n_15",
  "MopSsiK_Lapo4ka",
  "Shakoraze",
  "_Tecxas",
  "CAMOCYD",
  "VENOM_2011",
  "MaKenToshhh",
  "Ramzey_",
  "_pastich_",
  "Markowka_",
  "HukoJlau_06",
  "Mashukoo",
  "brookdluffy",
  "ZertinWard",
  "solumus_maximus",
  "Xinoki",
  "reaftie",
  "cpt_weedeye",
  "_LegaSyslik_",
  "MiloDer",
  "BanananT",
  "AsidSin",
  "Pronew_2019",
  "qweire",
  "raymccartan",
  "FOXyen",
  "0Sachalinec0",
  "masterskaya",
  "Coconut5364",
  "Nosicov",
  "CEKT0P",
  "Vampi_Is_Me",
  "Efreiter",
  "Homura128",
  "SnakeRuslan",
  "ky1nk1",
  "CyberKpblsa",
  "TimeSking",
  "alexpoint",
  "DanyaNeyk",
  "Molldyn",
  "Vocallolonik",
  "DKinchik",
  "prismerr",
  "Gorynych",
  "h1plex_my_kitten",
  "Tefynder",
  "monkey1447",
  "lobav",
  "Paxd1_",
  "Defenber",
  "srekko_f",
  "clownya57",
  "GEB0_",
  "EnoKast",
  "MerayFresh_",
  "Pax_Andronika",
  "AJleX57",
  "Kamandar",
  "TO_MUCH",
  "Vebstors",
  "SteamBuildier",
  "xligenda",
  "V00bz",
  "Hvani_femboy",
  "Alossser",
  "TPABOMAH_",
  "over144000",
  "Terendefloc",
  "lhijkb",
  "Nabuy",
  "firro17",
  "NeverLoveSky",
  "Lenyks",
  "analspazm",
  "HikaChinoowo",
  "Swino4ka",
  "opl69",
  "Forior",
  "_Kisel4ik_",
  "kriin_",
  "Mironelix",
  "CKyqp_B_nuBe",
  "Fristikon",
  "BoltozvakGaikoeb",
  "peesk",
  "Block_Peska",
  "layndner",
  "WenyaFox",
  "teflleg57",
  "Tsar_poketik",
  "TornPaint",
  "pgally",
  "Tinker_NOD",
  "A2ananasik",
  "00ABGz",
  "ShooxFuzll",
  "BIHGO",
  "Artemii023",
  "Semiraxd",
  "Sibistel",
  "DimaFyodorov",
  "s1ben",
  "ValikWho",
  "AVTO_LuxShisik",
  "deddda",
  "SergZt2279",
  "Kpaxmall",
  "Retselv",
  "LolKa255",
  "Korobka_1",
  "MrSidorovich",
  "dobrias",
  "DeL1TMe",
  "_boxee_",
  "12NikitaVins",
  "1_AlexCot_1",
  "UnkVirus",
  "cakechalk",
  "Xomkaaaaaa",
  "SpeeDPuppy",
  "00Daruma",
  "__Risa",
  "KolaPro",
  "Pepsik69",
  "jagermeisterADHP",
  "Assbecov_",
  "Oyasima",
  "kymoizi",
  "Lentasy",
  "vPups",
  "HENDELRINA",
  "Myatnaya",
  "Tashimka",
  "AllShab",
  "armorclub",
  "Hi_Craft",
  "ellipsiso",
  "kepckuk",
  "Mo0nRay",
  "Makrel3",
  "Sokich",
  "S1ark_",
  "Mayzito",
  "DiogEn_7",
  "KaisMais",
  "PianoCube3703",
  "Enarioo",
  "kirnau17",
  "Soyka82",
  "Foxyan4ik42",
  "Iaur",
  "__ZibsiS__",
  "Moksy44",
  "Ya_pivas",
  "Xanchyyk",
  "Elae4ik",
  "Comrade_Mikhail_",
  "she2kopr9d",
  "PaperPank",
  "Gnomik_Vasa",
  "fl3kseer92DOMA",
  "00SunRay00",
  "Kitekatura",
  "MaxLain",
  "mainhost",
  "NotsuruSound",
  "XYWINGS",
  "Oulls",
  "Pengven228",
  "vehers",
  "Differsion",
  "Starry_Blick",
  "IvTuSTAFF",
  "Upolnomoch_Kifir",
  "Irpen",
  "Pando4ka079",
  "AnderFan",
  "Brigella",
  "Kiryaaa",
  "ByR1lt1n",
  "flameach",
  "MAUCAT_bb",
  "krytoinosok",
  "Alexr27",
  "xKre3cikx",
  "semionik",
  "ADEKBATbI4",
  "0NxQ",
  "Tekletu",
  "SFastikF",
  "avale1648",
  "Prynik71",
  "kwexi",
  "Simakin",
  "_Denisiel_",
  "TebeNeSvetit",
  "Laever",
  "tr1color",
  "Genvey",
  "F1owering",
  "CyberPelmeshik",
  "rezdne_wagner",
  "_LuK__",
  "SVshka",
  "KOPOLb_SARATOVA",
  "MamdiKek",
  "obebaa",
  "Amadela_1",
  "povich92DOMA",
  "_ReadTree_",
  "AlexKraft8600",
  "T_zone_T",
  "janpol_",
  "Lopovski",
  "VesnaF",
  "Wioaru",
  "Yrent",
  "GYTU",
  "FenyaII",
  "loloipka",
  "Popi171201",
  "Osel3000",
  "MrCkiland",
  "ZalaForesta",
  "Kareux",
  "Srastich",
  "bergusha",
  "Kissalin",
  "Ohlamon",
  "utkanavt",
  "Barlisman",
  "MitoBBN",
  "noyuuuki",
  "KaRozik",
  "MrKodlin",
  "levnemcev",
  "PomeloS__",
  "biswec",
  "RenChik_",
  "Ak1ra_Horny",
  "shaizadinov",
  "MishaOv",
  "1_AlexFox_1",
  "Nordwain_",
  "Dava_Wasab",
  "Zadudoderr",
  "Ryrver",
  "Ksilexs",
  "YeLis64",
  "FruREN",
  "AlexBruuh",
  "fybrfo",
  "l1zunchik",
  "S1r1on",
  "DmitrySij",
  "CAPMAT",
  "SnrChuya",
  "Zannanel",
  "crazysecret",
  "Foxeoio751",
  "nurofenchik998",
  "_Neo_Samurai_8_",
  "Zabwenus",
  "1NkShizo",
  "Kitsune_Kyle",
  "NovaR1k92kB",
  "Tamommy",
  "BJlaD_CaBeJlbeB",
  "Samsami4ed",
  "egor__pomidor",
  "Modjik",
  "HutagerBack",
  "DIvan2000",
  "markosaft_",
  "Heronchek",
  "Mazir0k",
  "cheharka",
  "Ilyusha_1",
  "KutFat",
  "Zinino",
  "vpr_ru4_demo2023",
  "ZhuravlevX",
  "Fupnew",
  "Borsalss",
  "nekaede",
  "Sychie",
  "SleepWxlker",
  "_Gelzy",
  "_MrBee_",
  "_Ded_Perdet21_",
  "Jeleiaka",
  "1SantoLeLb",
  "Keorvane",
  "MrArekusu",
  "AKPHAK",
  "TRIPTOF4n",
  "UJIFERINA",
  "ByHanko",
  "Kislota",
  "Blarfik",
  "Revmatist",
  "flaidy42",
  "Ronan_Deilor",
  "lesaf",
  "1_gobnik",
  "kakashechka",
  "Joosyaww",
  "QuartzWaw",
  "Yashechka",
  "DranikUwU",
  "Comrade_Tokov",
  "LamyRka",
  "cutietuk",
  "iwtdie",
  "Gold1_",
  "korn4pl0d",
  "BO_SIN",
  "miyalvoda",
  "ignat_BO_SINN",
  "Dlesti",
  "Otto_Weiss",
  "Tsuk1ii",
  "Gribosvet",
  "Viktorovich_",
  "Xiiaoooo",
  "Dead_soul",
  "bitvu",
  "Animun4ik",
  "Cond1x01",
  "Kriss_Dark",
  "Fuyumiki",
  "apelSINUS",
  "Mohovidniy",
  "Galya_Fontan",
  "Difub",
  "Reamix_",
  "highiqmoney",
  "DoctorHell666",
  "Yanva",
  "Alex_Normalni",
  "A9C3C6",
  "poopirka",
  "AugustNV"
].map(name => name.toLowerCase());